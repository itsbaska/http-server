/*
 * This Java source file was generated by the Gradle 'init' task.
 */
import java.io.*;
import java.net.*;
import java.awt.Desktop;
import java.io.File;


public class HelloWorldServer {
    public void go() {
        try {
            ServerSocket serverSock = new ServerSocket(3000);

            while(true) {
                Socket server = serverSock.accept();
                System.out.println("got a request");
                InputStream inputStream = server.getInputStream();
                OutputStream outputStream = server.getOutputStream();

                int dataBytes;
                byte data[] = new byte[1024];
                dataBytes = inputStream.read(data);
                File helloWorld = new File("hello-world.html");

                BufferedReader reader = new BufferedReader(new FileReader(helloWorld));

                String line;
                String response = "";
                while ((line = reader.readLine()) != null) {
                    System.out.println(response += line);
                }

                String headers = "HTTP/1.1 200 OK\r\n" + "Content-Length: " + response.length() + "\r\n" + "Content-Type: text/html\r\n\r\n";

                outputStream.write((headers + response).getBytes("UTF-8"));
                outputStream.flush();
                server.close();
            }
        } catch(IOException ex) {
            ex.printStackTrace();
        }
    }
}
